---
title: '変更に柔軟なコンポーネントを作ろう #1'
description: 'ドメイン依存性とインターフェース、そして抽象化レベル'
pubDate: 'Oct 24 2024'
heroImage: '../../../assets/images/rabbit.webp'
category: 'Frontend'
tags: ['component']
lang: 'ja'
---

# なぜ変更に時間がかかるのか？

原因は以下の通りです。

1. コンポーネントインターフェースに結合された**ドメイン依存性**
2. **拡張不可能**なインターフェース
3. コンポーネント内部で使用する子コンポーネントの**抽象化レベル**が一貫していない

**インターフェース、インターフェース、インターフェース** インターフェースは重要です。

# コンポーネントインターフェースに結合されているドメイン依存性

例えば、XXXItemというコンポーネントを作ったとします。すると、XXXというドメイン内でしか使用できません。しかし、XXXItem、OOOItem?? これらは非常に多く使われています。類似の機能と動作なのに、常に新しく作成する必要があります。

## 解決プロセス

### すべてのコンテキストで使用できるように広くオープンにする。

### ドメインコンテキストを除去し、スタイル依存性について考察する

本当に多くの場所で使用でき、変更可能な余地が無限大になります。
しかし、機能は「OOItem表示」だが、スタイルが少し異なる場合はどうでしょうか？
機能が同一なので、このコンポーネントを再利用して生産性を向上させるのは自然な流れです。しかし？

TextではなくIconが追加される場合はどうでしょうか？その位置が前になったり後ろになったり、頻繁に変化します。これではどうでしょうか？

### Propsを追加して対応するのは良くない選択でした。

Propsが追加されればされるほど、要件が変更されるたびに（無限大）複雑になります。保守性が低下します。

### そのため、コンポーネントを細分化し、共通で使用する部分を分離しました。

良い方法ですが、私の実装はユーザーフレンドリーではありませんでした。
**使用側で決定できるように主導権を外部に委ねるべき**ですが、単に硬直したものを複数作成する結果になってしまいました。

# 拡張可能な構造

## 可能な限り標準インターフェースを使用する

```ts
interface Props extends LiHTMLAttributes<HTMLLIElement> {
	button?: ReactNode
}
```

標準インターフェースを拡張するだけで、非常に多くの助けになります。特に、自分の考えを抑制し、（ユーザーフレンドリーな）標準インターフェースを強制します。従わないとコンパイルが失敗するからです。

このPropsはli属性をそのまま使用できます。また、**データ構造**に関連するPropなしで、そのまま`children`を使用する必要があります。

インターフェースを考えるのが難しい場合は、まず標準インターフェースを拡張しましょう。その後で考えます。

## 命名は重要です。

オープンソースのデザインシステムライブラリで一般的に使用される**一般的な命名**をそのまま使用する方が良いです。

他の人は皆Switchと言い、onChangeというハンドラーを使用するのに、あなただけがToggle & onToggleと言わないでください。

## 子コンポーネントの抽象化レベルの一貫性

```tsx
function SomethingComponent({}: SomethingcomponentProps) {
	// 何らかのロジック

	return (
		<ParentSomething>
			<AAAFeature className='抽象化レベル1' />
			<BBBFeature className='抽象化レベル1' />
			<div className='ここで突然実装詳細が登場'>
				<CCCFeature className='抽象化レベル2' />
				<image href='でもここは抽象化ではない??' />
				<div className='でもここは抽象化ではない??' />
			</div>
		</ParentSomething>
	)
}
```

なぜこうなったのか、理解はできます。CCCFeatureは後からリクエストがあったのでしょう。しかし、これは正しいでしょうか？いいえ。

2週間後、または他の人がこのコードを見ると、目が疲れます。コンテキストを失い、多くの行き来が必要になります。一度に理解できません。

つまり、変更に時間がかかります。DDDFeatureを追加する際、どこに配置するか混乱が生じます。レベル1に配置したが、CCCFeatureが壊れた場合はどうでしょうか。結局、CCCFeatureをすべて読んだ後、どこに配置するか決定する必要があります。最悪の場合、CCCFeatureも修正する必要があります。
